/**
 * Comprehensive domain mapping for South Asian bridal fashion sites
 * Maps common incorrect domains to correct ones and validates URLs
 */

export const BRIDAL_DOMAINS = {
  // Major Marketplaces
  'aza.com': 'azafashions.com',
  'azafashions.com': 'azafashions.com',
  'www.azafashions.com': 'azafashions.com',
  
  'kynah.com': 'kynah.com',
  'www.kynah.com': 'kynah.com',
  
  'lashkaraa.com': 'lashkaraa.com',
  'www.lashkaraa.com': 'lashkaraa.com',
  
  'perniaspopupshop.com': 'perniaspopupshop.com',
  'www.perniaspopupshop.com': 'perniaspopupshop.com',
  'pernias.com': 'perniaspopupshop.com',
  'www.pernias.com': 'perniaspopupshop.com',
  
  'ogaan.com': 'ogaan.com',
  'www.ogaan.com': 'ogaan.com',
  
  'carmaonline.com': 'carmaonline.com',
  'www.carmaonline.com': 'carmaonline.com',
  
  'exclusivelyin.com': 'exclusivelyin.com',
  'www.exclusivelyin.com': 'exclusivelyin.com',
  'exclusively.in': 'exclusivelyin.com',
  
  'aashniandco.com': 'aashniandco.com',
  'www.aashniandco.com': 'aashniandco.com',
  
  'ensemble-india.com': 'ensemble-india.com',
  'www.ensemble-india.com': 'ensemble-india.com',
  
  'thecoutureco.com': 'thecoutureco.com',
  'www.thecoutureco.com': 'thecoutureco.com',
  
  'rivaazbykanishk.com': 'rivaazbykanishk.com',
  'www.rivaazbykanishk.com': 'rivaazbykanishk.com',
  
  'indiancouture.com': 'indiancouture.com',
  'www.indiancouture.com': 'indiancouture.com',
  
  'indianweddingbazaar.com': 'indianweddingbazaar.com',
  'www.indianweddingbazaar.com': 'indianweddingbazaar.com',
  
  // Designer Direct Sites (Top 50)
  'anitadongre.com': 'anitadongre.com',
  'www.anitadongre.com': 'anitadongre.com',
  
  'sabbyasachi.com': 'sabbyasachi.com',
  'www.sabbyasachi.com': 'sabbyasachi.com',
  
  'manishmalhotra.in': 'manishmalhotra.in',
  'www.manishmalhotra.in': 'manishmalhotra.in',
  'manishmalhotra.com': 'manishmalhotra.in',
  
  'rituravi.com': 'rituravi.com',
  'www.rituravi.com': 'rituravi.com',
  
  'abujanisandeepkhosla.com': 'abujanisandeepkhosla.com',
  'www.abujanisandeepkhosla.com': 'abujanisandeepkhosla.com',
  
  'rohitbal.com': 'rohitbal.com',
  'www.rohitbal.com': 'rohitbal.com',
  
  'taruntahiliani.com': 'taruntahiliani.com',
  'www.taruntahiliani.com': 'taruntahiliani.com',
  
  'rajibanshi.com': 'rajibanshi.com',
  'www.rajibanshi.com': 'rajibanshi.com',
  
  'payalsinghal.com': 'payalsinghal.com',
  'www.payalsinghal.com': 'payalsinghal.com',
  
  'riddhimehra.com': 'riddhimehra.com',
  'www.riddhimehra.com': 'riddhimehra.com',
  
  'anamikakhanna.com': 'anamikakhanna.com',
  'www.anamikakhanna.com': 'anamikakhanna.com',
  
  'gaurinavnindra.com': 'gaurinavnindra.com',
  'www.gaurinavnindra.com': 'gaurinavnindra.com',
  
  'suneetvarmaa.com': 'suneetvarmaa.com',
  'www.suneetvarmaa.com': 'suneetvarmaa.com',
  
  'seemaghani.com': 'seemaghani.com',
  'www.seemaghani.com': 'seemaghani.com',
  
  'punit-balana.com': 'punit-balana.com',
  'www.punit-balana.com': 'punit-balana.com',
  
  'varunbahl.com': 'varunbahl.com',
  'www.varunbahl.com': 'varunbahl.com',
  
  'jayantireddy.com': 'jayantireddy.com',
  'www.jayantireddy.com': 'jayantireddy.com',
  
  'masabagupta.com': 'masabagupta.com',
  'www.masabagupta.com': 'masabagupta.com',
  
  'svacouture.com': 'svacouture.com',
  'www.svacouture.com': 'svacouture.com',
  
  'rajandbhai.com': 'rajandbhai.com',
  'www.rajandbhai.com': 'rajandbhai.com',
  
  'payal-khandwala.com': 'payal-khandwala.com',
  'www.payal-khandwala.com': 'payal-khandwala.com',
  
  'kavitabhartia.com': 'kavitabhartia.com',
  'www.kavitabhartia.com': 'kavitabhartia.com',
  
  'payalgoenka.com': 'payalgoenka.com',
  'www.payalgoenka.com': 'payalgoenka.com',
  
  'nikitamhaisalkar.com': 'nikitamhaisalkar.com',
  'www.nikitamhaisalkar.com': 'nikitamhaisalkar.com',
  
  'ektaworld.com': 'ektaworld.com',
  'www.ektaworld.com': 'ektaworld.com',
  
  'jade-by-monica.com': 'jade-by-monica.com',
  'www.jade-by-monica.com': 'jade-by-monica.com',
  
  'pallavi-jaikishan.com': 'pallavi-jaikishan.com',
  'www.pallavi-jaikishan.com': 'pallavi-jaikishan.com',
  
  'itranpreet.com': 'itranpreet.com',
  'www.itranpreet.com': 'itranpreet.com',
  
  'paromita-banerjee.com': 'paromita-banerjee.com',
  'www.paromita-banerjee.com': 'paromita-banerjee.com',
  
  'kumariyam.com': 'kumariyam.com',
  'www.kumariyam.com': 'kumariyam.com',
  
  // International/UK Based
  'wellgroomed.co.uk': 'wellgroomed.co.uk',
  'www.wellgroomed.co.uk': 'wellgroomed.co.uk',
  
  'rishta.co.uk': 'rishta.co.uk',
  'www.rishta.co.uk': 'rishta.co.uk',
  
  'gulfsaris.com': 'gulfsaris.com',
  'www.gulfsaris.com': 'gulfsaris.com',
  
  'libas.in': 'libas.in',
  'www.libas.in': 'libas.in',
  
  'biba.in': 'biba.in',
  'www.biba.in': 'biba.in',
  
  'fabindia.com': 'fabindia.com',
  'www.fabindia.com': 'fabindia.com',
  
  'indianwedding.co.uk': 'indianwedding.co.uk',
  'www.indianwedding.co.uk': 'indianwedding.co.uk',
  
  // More Designer Sites (50+)
  'chameeandpalak.com': 'chameeandpalak.com',
  'www.chameeandpalak.com': 'chameeandpalak.com',
  
  'asthanarang.com': 'asthanarang.com',
  'www.asthanarang.com': 'asthanarang.com',
  
  'labelanushree.com': 'labelanushree.com',
  'www.labelanushree.com': 'labelanushree.com',
  
  'itrh.in': 'itrh.in',
  'www.itrh.in': 'itrh.in',
  
  'nitikamehra.com': 'nitikamehra.com',
  'www.nitikamehra.com': 'nitikamehra.com',
  
  'kavyachandra.com': 'kavyachandra.com',
  'www.kavyachandra.com': 'kavyachandra.com',
  
  'sonampandya.com': 'sonampandya.com',
  'www.sonampandya.com': 'sonampandya.com',
  
  'geethakakarlaa.com': 'geethakakarlaa.com',
  'www.geethakakarlaa.com': 'geethakakarlaa.com',
  
  'mehraavmeraki.com': 'mehraavmeraki.com',
  'www.mehraavmeraki.com': 'mehraavmeraki.com',
  
  'swativinayak.com': 'swativinayak.com',
  'www.swativinayak.com': 'swativinayak.com',
  
  'poojapanjwani.com': 'poojapanjwani.com',
  'www.poojapanjwani.com': 'poojapanjwani.com',
  
  'kaleekal.com': 'kaleekal.com',
  'www.kaleekal.com': 'kaleekal.com',
  
  'anjulbhandari.com': 'anjulbhandari.com',
  'www.anjulbhandari.com': 'anjulbhandari.com',
  
  'rajrajeshberi.com': 'rajrajeshberi.com',
  'www.rajrajeshberi.com': 'rajrajeshberi.com',
  
  'avaniagarwal.com': 'avaniagarwal.com',
  'www.avaniagarwal.com': 'avaniagarwal.com',
  
  'harleengambhir.com': 'harleengambhir.com',
  'www.harleengambhir.com': 'harleengambhir.com',
  
  'labeldinesh.com': 'labeldinesh.com',
  'www.labeldinesh.com': 'labeldinesh.com',
  
  'nitya-bajaj.com': 'nitya-bajaj.com',
  'www.nitya-bajaj.com': 'nitya-bajaj.com',
  
  'anavila.com': 'anavila.com',
  'www.anavila.com': 'anavila.com',
  
  'sureenacharatwani.com': 'sureenacharatwani.com',
  'www.sureenacharatwani.com': 'sureenacharatwani.com',
  
  'divyareddy.com': 'divyareddy.com',
  'www.divyareddy.com': 'divyareddy.com',
  
  'paridhillp.com': 'paridhillp.com',
  'www.paridhillp.com': 'paridhillp.com',
  
  'dollyj.com': 'dollyj.com',
  'www.dollyj.com': 'dollyj.com',
  
  'pamelamurphy.in': 'pamelamurphy.in',
  'www.pamelamurphy.in': 'pamelamurphy.in',
  
  'labelritu-kumar.com': 'labelritu-kumar.com',
  'www.labelritu-kumar.com': 'labelritu-kumar.com',
  
  'shyamalbhumika.com': 'shyamalbhumika.com',
  'www.shyamalbhumika.com': 'shyamalbhumika.com',
  
  'lecafe.co.in': 'lecafe.co.in',
  'www.lecafe.co.in': 'lecafe.co.in',
  
  'rajeshpratapsingh.com': 'rajeshpratapsingh.com',
  'www.rajeshpratapsingh.com': 'rajeshpratapsingh.com',
  
  'rohitgandhi-rahulkhanna.com': 'rohitgandhi-rahulkhanna.com',
  'www.rohitgandhi-rahulkhanna.com': 'rohitgandhi-rahulkhanna.com',
  
  'ampm.co.in': 'ampm.co.in',
  'www.ampm.co.in': 'ampm.co.in',
  
  '6degreestudio.com': '6degreestudio.com',
  'www.6degreestudio.com': '6degreestudio.com',
  
  'architha-narayanam.com': 'architha-narayanam.com',
  'www.architha-narayanam.com': 'architha-narayanam.com',
  
  'pratha-by-harini.com': 'pratha-by-harini.com',
  'www.pratha-by-harini.com': 'pratha-by-harini.com',
  
  'kanika-goyal.com': 'kanika-goyal.com',
  'www.kanika-goyal.com': 'kanika-goyal.com',
  
  'suketdhir.com': 'suketdhir.com',
  'www.suketdhir.com': 'suketdhir.com',
  
  'rrbyrorooprani.com': 'rrbyrorooprani.com',
  'www.rrbyrorooprani.com': 'rrbyrorooprani.com',
  
  'ayushkejriwal.com': 'ayushkejriwal.com',
  'www.ayushkejriwal.com': 'ayushkejriwal.com',
  
  'shivan-narresh.com': 'shivan-narresh.com',
  'www.shivan-narresh.com': 'shivan-narresh.com',
  
  'myoho.in': 'myoho.in',
  'www.myoho.in': 'myoho.in',
  
  // Menswear/Groom
  'raghavendra-rathore.com': 'raghavendra-rathore.com',
  'www.raghavendra-rathore.com': 'raghavendra-rathore.com',
  
  'raymondnext.com': 'raymondnext.com',
  'www.raymondnext.com': 'raymondnext.com',
  
  'manyavar.com': 'manyavar.com',
  'www.manyavar.com': 'manyavar.com',
  
  // Jewelry & Accessories
  'tanishq.co.in': 'tanishq.co.in',
  'www.tanishq.co.in': 'tanishq.co.in',
  
  'caratlane.com': 'caratlane.com',
  'www.caratlane.com': 'caratlane.com',
  
  'amrapalijewels.com': 'amrapalijewels.com',
  'www.amrapalijewels.com': 'amrapalijewels.com',
  
  'needleduet.com': 'needleduet.com',
  'www.needleduet.com': 'needleduet.com',
};

export function getCorrectDomain(url: string): string {
  try {
    const hostname = new URL(url).hostname.toLowerCase();
    return BRIDAL_DOMAINS[hostname] || hostname;
  } catch {
    return url;
  }
}

export function fixBridalUrl(url: string): string {
  try {
    const parsedUrl = new URL(url);
    const correctDomain = getCorrectDomain(url);
    
    // If domain needs correction, rebuild URL
    if (correctDomain !== parsedUrl.hostname) {
      parsedUrl.hostname = correctDomain;
      return parsedUrl.toString();
    }
    
    return url;
  } catch {
    return url;
  }
}

export function isBridalSite(url: string): boolean {
  try {
    const hostname = new URL(url).hostname.toLowerCase().replace('www.', '');
    return Object.keys(BRIDAL_DOMAINS).some(domain => 
      hostname.includes(domain.replace('www.', ''))
    );
  } catch {
    return false;
  }
}

export function cleanProductUrl(url: string): string {
  try {
    const parsedUrl = new URL(url);
    
    // Remove tracking parameters
    const trackingParams = [
      'utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term',
      'fbclid', 'gclid', 'msclkid', '_ga', 'mc_cid', 'mc_eid',
      'ref', 'source', 'campaign'
    ];
    
    trackingParams.forEach(param => {
      parsedUrl.searchParams.delete(param);
    });
    
    return parsedUrl.toString();
  } catch {
    return url;
  }
}
